# 一些概念
HTTP并不是单独存在，学习HTTP之前，了解一些其他的相关内容。本系列主要是总结学习过的资料（某慕视频，《图解HTTP》），并综合自己的理解和工作中的例子记录下。方便自己查阅和学习。

## TCP/IP
也叫TCP/IP协议族，并不止TCP和IP两个协议，还包含了如FTP，HTTP等协议。

### TCP/IP的分层管理
1. *应用层*，决定了向用户提供应用服务时通信的活动。HTTP就在这层。
2. *传输层*，提供网络连接中2台计算机之间的数据传输。这里有TCP和UDP协议。两者相比，简单的区别就是，TCP提供的是稳定可靠的传输，而UPD提供的是低稳定，低可靠，比较经济实用的传输。
3. *网络层*，用来处理网络上流动的数据包（抓包抓的就是数据包），选择一条传输线路到达对方计算机。
4. *链路层*，网络接口层处理硬件部分，如光纤网卡等物理可见部分。

**IP**（负责传输）
IP协议负责传输，处在网络层，将数据包传输给对方。当然你得知道传给谁（需要IP地址和MAC地址）。理论上，MAC地址和IP地址都是唯一的，但IP地址可变，MAC地址跟硬件绑定不可变。往IP地址（192.168.xx.xx）发送，通过`ARP`协议解析出对应的MAC地址（真正的服务器所在地）

**TCP**（负责可靠性）
提供字节流服务，为方便传输，将数据分割成以报文段为单位的数据包。之所以负责可靠性，是因为TCP协议能够确认数据最终是否送达对方。

**DNS**
负责域名解析。简单来说就是，`http://www.baidu.com`转变到对应的IP地址`xxx.xxx.xxx.xxx`

## URI和URL
**URI**（统一资源标识符），即用字符串标识某一互联网*资源*。如人的名字。

**URL**（统一资源定位符），即用字符表示资源的*地点*。如这个人在哪里。

可以说URL是URI的子集。

### URI格式
`http://user:pass@www.example.jp:80/dir/index.html?uid=1#ch1`

一段URI链接，有协议（http），登录信息（user.pass），域名（www.example.jp），端口号（80），文件路径（dir/index.html），查询字符串（?uid=1），hash（#ch1）等组成。


## HTTP
http，也叫超文本传输协议（如今主要是1.1版本），是现如今互联网使用范围最广和使用频率最高的网络协议。使用HTTP协议用于客户端和服务端之间的通信，必定是一端是客户端，一端是服务端。

### 无状态特点
不会记录状态，即每次产生新的请求，都不会保留前一次请求或响应的信息。不利于用户管理，因此有了`cookie`，通过cookie来标识每次请求到底是哪个家伙。

## 三次握手

### HTTP和TCP的关系
HTTP主要就是请求和响应，而请求和响应是通过数据包传输来让客户端和服务端通信的，传输必定需要一个传送*通道*。

通道是TCP来建立，为了确保通道的稳定性和可靠性，TCP会进行一个叫做三次握手的通道创建方式。

### TCP的三次握手过程。
1. 客户端发送一个包含`SYN`标志的数据包给服务端。
2. 服务端接收到`SYN`标志的数据包后，回传一个包含`SYN/ACK`标志的数据包。
3. 客户端接收到`SYN/ACK`标志的是数据包后，回传一个包含`ACK`标志的数据包。
   
至此三次握手过程完成。引用下《图解HTTP》书中的插图和一张使用wlan抓包工具的TCP三次握手图。
![three-hands](./img/Jietu20181118-182250.jpg)
![three-hands2](./img/tcp-three-shake-hands.png)

### 成本
三次握手本身建立连接，也是通信成本。

在**HTTP1.0**中，每次TCP连接成功后，完成一次传输，都会断开TCP。然后下次有请求，继续重复建立TCP通道。

在**HTTP1.1**中，TCP通道建立后，不在立即断开，而是在一段时间内，等待其他协议如HTTP请求复用该通道，等到长时间无请求，或明确的要求断开，才会断开。也就是我们常会在chrome控制台的network选项卡中经常看到的一个请求的响应头`Connection: keep-alive`

另外，浏览器本身对并发的TCP连接，也是有数量限制的，并发请求超出TCP链接上限后，新的连接需要等到前面已经创建好的TCP通道空闲时才能使用。例如chrome，并发数有6个，如果同时有7个请求，则第7个要等到前面6个中有一个完成后才能继续。如图：
![tcp-num](./img/long-connect.png)

### HTTP请求报文
HTTP很大一部分内容都在它的报文上，由请求报文和响应报文构成。报文中又有各种头部字段，请求行（针对请求报文），状态航（针对响应报文）。对于前端来说，了解常用的报文，头部字段的含义和使用很重要。比如最常见的缓存机制如何实现，就需要清楚了解相关的知识。


基本关于前端常见的一些概念先总结如上，后面如果有缺再补。